# 🧪 本地测试指南

## 问题解决状态

✅ **已修复**：机器人关节调试界面和3D渲染窗口现在都正常显示

## 🚀 在您的本地环境测试

### 第一步：更新代码
```bash
cd ~/thu/robotsim

# 清理编译文件（避免git pull冲突）
make clean 2>/dev/null || true
rm -f Makefile *.o moc_*.cpp moc_*.h ui_*.h robot_control_gui

# 拉取最新代码
git pull origin main
```

### 第二步：编译项目
```bash
# 生成Makefile
qmake

# 编译项目
make

# 或者如果有编译脚本
./build_project.sh
```

### 第三步：运行程序
```bash
# 直接运行
./robot_control_gui

# 如果遇到显示问题，尝试设置环境变量
export QT_QPA_PLATFORM=xcb
./robot_control_gui
```

## 🔍 预期界面布局

运行程序后，您应该看到以下界面：

### 左侧区域（垂直分割）
1. **上半部分 - 关节控制标签页**
   - 包含"关节控制"标签页
   - 显示所有21个关节的控制滑块：
     - 🦾 左臂关节 (8个)：关节1-8
     - 🦾 右臂关节 (8个)：关节9-16  
     - 🏃 腰部关节 (2个)：关节17-18
     - 🚗 底盘电机 (2个)：关节19-20
     - ⬆️ 升降机构 (1个)：关节21

2. **下半部分 - 3D渲染窗口**
   - 标题："机器人3D视图"
   - 黑色背景的渲染区域
   - 彩色坐标轴：X(红)、Y(绿)、Z(蓝)
   - 灰色网格背景
   - 底部状态："渲染状态: 就绪"

### 右侧控制面板
1. **连接控制** - 包含新的仿真模式复选框
2. **位置控制** - 位置保存/加载功能
3. **关节控制** - 批量启用/禁用
4. **状态信息** - 连接状态、电池等
5. **运动状态监控** - 实时运动信息

## 🧪 功能测试

### 测试仿真模式
1. 勾选右侧"连接控制"面板中的"☑️ 仿真模式"
2. 观察变化：
   - "连接机器人"和"断开连接"按钮被禁用
   - 所有关节控制滑块变为可用状态
   - 3D渲染窗口状态变为"渲染状态: 仿真模式"
   - 日志显示"仿真模式已启用"

### 测试关节控制
1. 在仿真模式下，拖动任意关节滑块
2. 观察：
   - 滑块值实时更新
   - 运动状态监控显示变化
   - 日志记录关节值变化

### 测试3D渲染窗口
1. 确认渲染窗口显示：
   - 坐标轴正确显示（X-红，Y-绿，Z-蓝）
   - 网格背景可见
   - 状态标签正确显示当前状态

## 🐛 如果遇到问题

### 问题1：界面不显示或崩溃
```bash
# 尝试不同的显示后端
export QT_QPA_PLATFORM=xcb
./robot_control_gui

# 或者
export QT_QPA_PLATFORM=wayland
./robot_control_gui
```

### 问题2：关节控制界面缺失
- 检查是否正确拉取了最新代码
- 重新编译项目：`make clean && qmake && make`
- 确认mainwindow.cpp包含setupJointControls()函数

### 问题3：3D渲染窗口黑屏
- 这是正常的，当前版本显示基础的坐标轴和网格
- 确认能看到红绿蓝三色坐标轴
- 确认底部有"渲染状态"标签

### 问题4：编译错误
```bash
# 确保Qt5开发包完整
sudo apt update
sudo apt install qt5-default qtbase5-dev qtbase5-dev-tools

# 清理后重新编译
make clean
qmake
make
```

## 📊 验证清单

运行程序后，请确认以下项目：

- [ ] 程序正常启动，无崩溃
- [ ] 左侧显示关节控制标签页
- [ ] 可以看到21个关节控制滑块（分5组）
- [ ] 左侧下方显示3D渲染窗口
- [ ] 3D渲染窗口有坐标轴和网格
- [ ] 右侧显示完整的控制面板
- [ ] 连接控制面板包含"仿真模式"复选框
- [ ] 仿真模式可以正常切换
- [ ] 在仿真模式下关节控制可用
- [ ] 运动状态监控正常显示
- [ ] 日志面板记录操作信息

## 🎉 成功标志

如果您看到了以下界面，说明修复成功：

```
┌─────────────────────────────────────────────────────────┐
│                机器人控制上位机                          │
├─────────────────────────────┬───────────────────────────┤
│     关节控制标签页           │      控制面板区域          │
│  [关节1] [关节2] [关节3]...  │  ┌─────────────────────┐  │
├─────────────────────────────┤  │   🔗 连接控制       │  │
│      机器人3D视图            │  │   ☑️ 仿真模式       │  │
│  Y↑   Z↗                    │  └─────────────────────┘  │
│   │  /   ████████████       │                           │
│   │ /    ████████████       │  [其他控制面板...]        │
│   └────→ X                  │                           │
│  渲染状态: 就绪              │                           │
└─────────────────────────────┴───────────────────────────┘
```

## 📞 需要帮助？

如果在测试过程中遇到任何问题，请提供：
1. 错误信息截图
2. 终端输出日志
3. 系统信息（Ubuntu版本、Qt版本）
4. 具体的操作步骤

这样我可以更好地帮助您解决问题！